(
    function ($) {
  "use strict";

  var gateway = 'other';
  $('#gatwayCard').on('change', 'input[name="gateway"]', function (e) {



    $("#cardarea").show();
    e.preventDefault();
    $('button#paymentSubmit').removeAttr('disabled');
    gateway = $(this).attr('data-class');
  });

  $('#offlinePayment').on('change', 'input[name="gateway"]', function (e) {

    $("#cardarea").hide();
    e.preventDefault();
    $('button#paymentSubmit').removeAttr('disabled');


    gateway = $(this).attr('data-class');
  });



  $('#paymentSubmit').on('click', function (e) {

if(gateway == "credit"){

    e.preventDefault();
    $(this).closest('form').trigger('submit');

}else{

    e.preventDefault();

    var stripekey = $('#key').val();
            var $form = $("#require-validation");



                var $form  = $("#require-validation");




                if (!$form.data('cc-on-file')) {
                  e.preventDefault();
                  Stripe.setPublishableKey(stripekey);
                  Stripe.createToken({
                    number: $('.card-number').val(),
                    cvc: $('.card-cvc').val(),
                    exp_month: $('.card-expiry-month').val(),
                    exp_year: $('.card-expiry-year').val()
                  }, stripeResponseHandler);
                }



          function stripeResponseHandler(status, response) {
                if (response.error) {
                    $('.error')
                        .removeClass('hide')
                        .addClass('alert alert-danger')
                        // .find('.alert')
                        .text(response.error.message);
                } else {
                    /* token contains id, last4, and card type */
                    var token = response['id'];
                    $form.find('input[type=text]').empty();
                    $form.append("<input type='hidden' name='stripeToken' value='" + token + "'/>");

                    $form.get(0).submit();
                }
            }

}





  });
})(jQuery);


